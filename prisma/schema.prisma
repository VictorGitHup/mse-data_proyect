generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["driverAdapters"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id              String    @id @default(cuid())
  email           String    @unique
  password        String
  name            String?
  ads             Ad[]
  ratingsGiven    Rating[]
  paymentsMade    Payment[]
  createdAt       DateTime  @default(now())
  updatedAt       DateTime  @updatedAt
}

model Ad {
  id              String     @id @default(cuid())
  title           String
  description     String
  price           Float
  author          User       @relation(fields: [authorId], references: [id])
  authorId        String
  category        Category   @relation(fields: [categoryId], references: [id])
  categoryId      String
  tags            Tag[]      @relation("AdTags")
  ratings         Rating[]
  payments        Payment[]
  createdAt       DateTime   @default(now())
  updatedAt       DateTime   @updatedAt
}

model Category {
  id              String   @id @default(cuid())
  name            String   @unique
  ads             Ad[]
}

model Tag {
  id              String   @id @default(cuid())
  name            String   @unique
  ads             Ad[]     @relation("AdTags")
}

model Rating {
  id              String   @id @default(cuid())
  value           Int
  comment         String?
  ad              Ad       @relation(fields: [adId], references: [id])
  adId            String
  author          User     @relation(fields: [authorId], references: [id])
  authorId        String
  createdAt       DateTime @default(now())
}

model Payment {
  id              String   @id @default(cuid())
  amount          Float
  currency        String
  status          String
  ad              Ad       @relation(fields: [adId], references: [id])
  adId            String
  payer           User     @relation(fields: [payerId], references: [id])
  payerId         String
  createdAt       DateTime @default(now())
}
